<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link href="/main.css" rel="stylesheet" />
</head>

<body class="grey-bg">
  <%- include('nav.ejs') %>
    <!-- <%= JSON.stringify(ê¸€ëª©ë¡) %> -->
    <input class="search" name="searchQuery" id="searchQuery" />
    <button class="search-send">ê²€ìƒ‰</button>
    <div class="white-bg">
      <% for(let i=0; i < ê¸€ëª©ë¡.length ; i++) { %>
        <div class="list-box">
          <h4>
            <a href="detail/<%= ê¸€ëª©ë¡[i]._id %>">
              <%= ê¸€ëª©ë¡[i].title %>
            </a>
            <a href="/edit/<%= ê¸€ëª©ë¡[i]._id %>">âœï¸</a>
            <!-- ì‚­ì œë²„íŠ¼ì— idë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ê¸€ì˜ _idë¥¼ ìˆ¨ê²¨ë†“ì„ ìˆ˜ ìˆë‹¤. -->
            <button class="delete" data-id="<%= ê¸€ëª©ë¡[i]._id %>">ğŸ—‘ï¸</button>
          </h4>
          <p>
            <%= ê¸€ëª©ë¡[i].content %>
          </p>

        </div>
        <% } %>
    </div>
    <a href="/list/next/<%= ê¸€ëª©ë¡[ê¸€ëª©ë¡.length-1]._id%>">ë‹¤ìŒ</a>
    <script>
      console.log("<%= ê¸€ëª©ë¡[0]._id %>");
      //ë°©ë²•1
      // document
      //   .querySelectorAll(".delete")[0]
      //   .addEventListener("click", function () {
      //     fetch("/delete?docid=<%= ê¸€ëª©ë¡[0]._id %>", { method: "DELETE" });
      //   });

      //ë°©ë²•2(ì¢€ ë” ì •í™•í•œ ë°©ë²•)
      // document
      //   .querySelectorAll(".delete")
      //   .addEventListener("click", function (e) {
      //     fetch("/delete?docid=" + e.target.dataset.id, {
      //       method: "DELETE",
      //     });
      //   });

      let deleteButtons = document.querySelectorAll('.delete');
      deleteButtons.forEach(function (button) {
        button.addEventListener('click', function (e) {
          console.log('ì‚­ì œí•  ë²„íŠ¼ ì•„ì´ë””', e.target.dataset.id)
          fetch('/delete?docid=' + e.target.dataset.id, {
            method: 'DELETE',
          })
        });
      });


      //ë²„íŠ¼ ì°¾ê¸°
      document
        .querySelector(".search-send")
        .addEventListener("click", function () {
          let ì…ë ¥í•œê±° = document.querySelector(".search").value;
          location.href = "/search?val=" + ì…ë ¥í•œê±°;
        });
    </script>
</body>

</html>